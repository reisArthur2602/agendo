generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id         String     @id @default(cuid())
  email      String     @unique
  name       String
  image      String
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
  businesses Business[]
}

model Business {
  id           String           @id @default(cuid())
  ownerId      String
  name         String
  slug         String           @unique
  description  String?
  niche        String?
  logoUrl      String?
  whatsapp     String?
  instagram    String?
  layout       LayoutType       @default(CLASSIC)
  createdAt    DateTime         @default(now())
  updatedAt    DateTime         @updatedAt
  plan         Plan             @default(FREE)
  appointments Appointment[]
  owner        User             @relation(fields: [ownerId], references: [id])
  services     Service[]
  schedules    WeeklySchedule[]
}

model Service {
  id           String        @id @default(cuid())
  businessId   String
  name         String
  description  String?
  duration     Int
  price        Decimal       @db.Decimal(10, 2)
  appointments Appointment[]
  business     Business      @relation(fields: [businessId], references: [id])
}

model WeeklySchedule {
  id         String     @id @default(cuid())
  businessId String
  dayOfWeek  Int
  isActive   Boolean    @default(true)
  timeSlots  TimeSlot[]
  business   Business   @relation(fields: [businessId], references: [id])
}

model TimeSlot {
  id               String         @id @default(cuid())
  weeklyScheduleId String
  startTime        String
  endTime          String
  schedule         WeeklySchedule @relation(fields: [weeklyScheduleId], references: [id])
}

model Appointment {
  id            String   @id @default(cuid())
  businessId    String
  serviceId     String
  date          DateTime
  customerName  String
  customerPhone String
  createdAt     DateTime @default(now())
  business      Business @relation(fields: [businessId], references: [id])
  service       Service  @relation(fields: [serviceId], references: [id])
}

enum Plan {
  FREE
  PRO
  PREMIUM
}

enum LayoutType {
  CLASSIC
  MINIMAL
  ESTHETIC
}
